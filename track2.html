<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>紀錄中，請稍候...</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <p>正在紀錄您的點擊，請稍候跳轉...</p>

  <script>
    // ✅ 這裡改成你的 Firebase 設定
    const firebaseConfig = {
    apiKey: "AIzaSyCecDzYKiakbQYyvG3E1OGQDAINgSYhEW8",
    authDomain: "social-test-c3afc.firebaseapp.com",
    projectId: "social-test-c3afc",
    storageBucket: "social-test-c3afc.firebasestorage.app",
    messagingSenderId: "974958380923",
    appId: "1:974958380923:web:7fb88ad13ee7a353c41fde"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const urlParams = new URLSearchParams(window.location.search);
    const uid = urlParams.get('uid') || 'unknown';
    const userAgent = navigator.userAgent;
    const timestamp = new Date().toISOString();

    fetch("https://api.ipify.org?format=json")
      .then(response => response.json())
      .then(data => {
        const ip = data.ip;

        db.ref("clicks/" + encodeURIComponent(uid)).push({
          timestamp: timestamp,
          ip: ip,
          userAgent: userAgent
        });

        setTimeout(() => {
          window.location.href = "https://forms.gle/HxL1jrV8hGREvkt3A";  // ✅ 你的表單
        }, 1000);
      })
      .catch(() => {
        setTimeout(() => {
          window.location.href = "https://forms.gle/HxL1jrV8hGREvkt3A";
        }, 1000);
      });
  </script>
</body>
</html>
