<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>點擊追蹤</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
</head>
<body>
  <h2>載入中...</h2>

  <script>
    // ✅ 你的 Firebase 設定
    const firebaseConfig = {
      apiKey: "AIzaSyCecDzYKiakbQYyvG3E1OGQDAINgSYhEW8",
      authDomain: "social-test-c3afc.firebaseapp.com",
      databaseURL: "https://social-test-c3afc-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "social-test-c3afc",
      storageBucket: "social-test-c3afc.appspot.com",
      messagingSenderId: "974958380923",
      appId: "1:974958380923:web:7fb88ad13ee7a353c41fde"
    };

    // ✅ 初始化 Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // ✅ 寫入點擊紀錄到 `/clicks`
    const logClick = () => {
      const now = new Date();
      const timestamp = now.toISOString();
      const userAgent = navigator.userAgent;

      const data = {
        timestamp,
        userAgent,
        redirected: true
      };

      // ✅ 推入 clicks 節點
      firebase.database().ref('clicks').push(data)
        .then(() => {
          // ✅ 寫入成功 → 導向 Google 表單或其他網址
          window.location.href = "https://docs.google.com/forms/d/e/1FAIpQLSdUyYtC...你的表單ID.../viewform";
        })
        .catch((error) => {
          console.error("寫入失敗：", error);
          document.body.innerHTML = "<h2>寫入 Firebase 失敗</h2>";
        });
    };

    // ✅ 自動觸發（載入後即執行）
    window.onload = logClick;
  </script>
</body>
</html>
